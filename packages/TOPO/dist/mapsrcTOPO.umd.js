var T=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var v=(i,p)=>{var S={};for(var a in i)J.call(i,a)&&p.indexOf(a)<0&&(S[a]=i[a]);if(i!=null&&T)for(var a of T(i))p.indexOf(a)<0&&N.call(i,a)&&(S[a]=i[a]);return S};(function(i,p){typeof exports=="object"&&typeof module!="undefined"?p(exports):typeof define=="function"&&define.amd?define(["exports"],p):(i=typeof globalThis!="undefined"?globalThis:i||self,p(i.mapsrcTOPO={}))})(this,function(i){"use strict";let p={type:"FeatureCollection",features:[]};const S=e=>(e._GeoJSONSource||(e.style.addSource("$geojson",{type:"geojson",data:p}),e._GeoJSONSource=e.style.getSource("$geojson").constructor,e.style.removeSource("$geojson")),e._GeoJSONSource);function a(e,n){for(var t,s=e.length,u=s-n;u<--s;)t=e[u],e[u++]=e[s],e[s]=t}function F(e){return e}function G(e){if(e==null)return F;var n,t,s=e.scale[0],u=e.scale[1],c=e.translate[0],f=e.translate[1];return function(y,d){d||(n=t=0);var g=2,r=y.length,o=new Array(r);for(o[0]=(n+=y[0])*s+c,o[1]=(t+=y[1])*u+f;g<r;)o[g]=y[g],++g;return o}}function P(e,n){return typeof n=="string"&&(n=e.objects[n]),n.type==="GeometryCollection"?{type:"FeatureCollection",features:n.geometries.map(function(t){return b(e,t)})}:b(e,n)}function b(e,n){var t=n.id,s=n.bbox,u=n.properties==null?{}:n.properties,c=_(e,n);return t==null&&s==null?{type:"Feature",properties:u,geometry:c}:s==null?{type:"Feature",id:t,properties:u,geometry:c}:{type:"Feature",id:t,bbox:s,properties:u,geometry:c}}function _(e,n){var t=G(e.transform),s=e.arcs;function u(r,o){o.length&&o.pop();for(var l=s[r<0?~r:r],h=0,m=l.length;h<m;++h)o.push(t(l[h],h));r<0&&a(o,m)}function c(r){return t(r)}function f(r){for(var o=[],l=0,h=r.length;l<h;++l)u(r[l],o);return o.length<2&&o.push(o[0]),o}function y(r){for(var o=f(r);o.length<4;)o.push(o[0]);return o}function d(r){return r.map(y)}function g(r){var o=r.type,l;switch(o){case"GeometryCollection":return{type:o,geometries:r.geometries.map(g)};case"Point":l=c(r.coordinates);break;case"MultiPoint":l=r.coordinates.map(c);break;case"LineString":l=f(r.arcs);break;case"MultiLineString":l=r.arcs.map(f);break;case"Polygon":l=d(r.arcs);break;case"MultiPolygon":l=r.arcs.map(d);break;default:return null}return{type:o,coordinates:l}}return g(n)}const O=e=>class extends S(e){constructor(t,y,c,f){var d=y,{data:s}=d,u=v(d,["data"]);super(t,Object.assign(u,{data:p}),c,f);this.id=t,this.type="geojson",this._options.data=s,u.topoFilter?this.setTOPOFilter(u.topoFilter):this.setData(s)}setData(t){if(typeof t=="string"||t instanceof String){var s=new XMLHttpRequest;s.open("GET",t),s.responseType="json",s.addEventListener("load",()=>this.setData(s.response)),s.send()}else if(t&&t.type=="Topology"){this._options.data=t;let c=this._options.topoFilter;Array.isArray(c)&&(c={type:"GeometryCollection",geometries:c.map(f=>t.objects[f])}),c||(c={type:"GeometryCollection",geometries:Object.values(t.objects)});var u=P(t,c);super.setData(u)}else console.error("TopoJSONSource expects a URL or a TopoJSON as 'data'");return this}setTOPOFilter(t){return this._options.fgbFilter=t,this.setData(this._options.data),this}},j=function(e,n){e.addSourceType("topojson",O(e),n)};i.addSourceTypeGPBF=j,i.default=j,i.getSourceTypeTOPO=O,Object.defineProperty(i,"__esModule",{value:!0}),i[Symbol.toStringTag]="Module"});
